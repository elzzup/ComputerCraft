r = 0
e = 0
f = 0

h = fs.open("/log", "a") -- ログファイルに出力する
h.write("---- start ---- \n")

function erorrLog(...) -- エラーの場合 ログを出力する
	if not r then
		h.write(e.."\n")
		h.flush()
	end
end

function fuelLv(...) -- 現在の燃料が80以下だったら補給する
	f = turtle.getFuelLevel()
	print ("\n -----"..f.."----- \n")
	if f <= 80 then
		print "please refuel"
	end
end

function itemGet(...) -- 10秒おきにアイテムを取得する
	while 10 >= turtle.getItemCount(1) do
		sleep(10)
		print "start waiting..."
		turtle.select(1)
		r , e = turtle.suck()
		erorrLog()
	end
end

function kamado(...) -- かまどへ往復
	-- 旦那さんのところからかまどへ向かう
	turtle.turnLeft()
	for i = 1, 5 do
		turtle.forward()
	end

	-- 部屋に入る
	turtle.turnLeft()
	turtle.forward()
	turtle.forward()

	-- かまどの上へ
	turtle.turnLeft()
	turtle.up()
	turtle.forward()

	-- かまどに素材を入れる
	turtle.select(1)
	turtle.dropDown(8) -- 1アイテムあたり10秒精錬にかかる

	-- 側面にまわる
	turtle.turnRight()
	turtle.forward()
	turtle.down()
	turtle.turnLeft()
	turtle.turnLeft()

	-- かまどに燃料を入れる
	turtle.select(16)
	turtle.drop(1)

	-- 元にもどる
	turtle.turnLeft()
	turtle.forward()
	turtle.turnRight()
	turtle.forward()
	turtle.forward()
	turtle.forward()
	turtle.turnRight()
	for i = 1, 5 do
		turtle.forward()
	end
	turtle.turnLeft()
end

while true do
	itemGet()
	if r then -- もしアイテムが取得できたら
		if f <= 80 then
			kamado()
			h.write("true \n")
			h.flush()
		end
	else -- 取得できなかったら
		itemGet()
		h.write("onemore check \n")
		h.flush()
	end 
end